<!--
  <div ui-view class="container-fluid">
    <h1>Leaderboard</h1>
    {{> leaderboard }}
    {{> addPlayerForm}}
    {{> loginButtons}}
  </div>
-->
<head>
  <link rel="icon" sizes="16x16 32x32" href="/img/favicon.ico">
  <link href='https://fonts.googleapis.com/css?family=Oxygen:400,300,700|Roboto:400,100|Oxygen+Mono' rel='stylesheet' type='text/css'>
  
  <style>
    /* Force navbar spacing */
    body {
      padding-top: 80px !important;
    }
    
    /* Force footer padding */
    .footer {
      padding: 20px 30px !important;
    }
    
    .footer p {
      margin: 20px !important;
      padding: 0 20px !important;
    }
  </style>
</head>

<body>
  {{> main}}
</body>

<template name="leaderboard">
        <div class="container">
          <div class="row">
            <div class="col-lg-3 col-md-2"></div>
            <div class="col-lg-6 col-md-8 col-xs-12">
              <h2>Leaderboard</h2>
            </div>
            <div class="col-lg-3 col-md-2"></div>
          </div>
          <div class="row">
            <div class="col-lg-3 col-md-2"></div>
            <div class="col-lg-6 col-md-8 col-xs-12">
              <table class="table table-condensed">
                <thead>
                  <tr>
                    <th>Player</th>
                    <th>Time (seconds)</th>
                    <th>Date</th>
                  </tr>
                </thead>
                <tbody>
                  {{#each player}}
                    <tr>
                      <td>{{{trophycolor @index}}} {{player_alias}}</td>
                      <td>{{oneDP score}}</td>
                      <td>{{dateformat date}}</td>
                    </tr>
                  {{/each}}
                </tbody>
              </table>
            </div>
            <div class="col-lg-3 col-md-2"></div>
          </div> <!--row-->
        </div>

      <div class="container">
        <div class="row">
          <div class="col-lg-3 col-md-2"></div>
          <div class="col-lg-6 col-md-8 col-xs-12">
            <h2>My Personal Best Times</h2>
          </div>
          <div class="col-lg-3 col-md-2"></div>
        </div>
        <div class="row">
          <div class="col-lg-3 col-md-2"></div>
          <div class="col-lg-6 col-md-8 col-xs-12">
            <table class="table table-condensed">
              <thead>
                <tr>
                  <th>Time (seconds)</th>
                  <th>Date</th>
                </tr>
              </thead>
              <tbody>
                {{#each measplayer}}
                  <tr>
                    <td>{{oneDP score}}</td>
                    <td>{{dateformat date}}</td>
                  </tr>
                {{/each}}
              </tbody>
            </table>
          </div>
          <div class="col-lg-3 col-md-2"></div>
        </div> <!--row-->
      </div> <!-- container -->
</template>


<template name = "refractGame">
  <div class="container-fluid" id="canvascontainer">
    <canvas id ="specsCanvas" align="left"> </canvas>
  </div>
</template>

<template name="home">
    <div class="container-fluid">
      <div class="jumbotron">
        <div class="row">
          <div class="col-lg-12 col-sm-12">
            <div class="col-lg-8 col-sm-6">
              <h1 class='refract'>Welcome to Refr<span style="color: #000000"><strong>act</strong></span></h1>
              <lead>optometry training under the lens</lead>
            </div>
            <div class="col col-lg-4 col-sm-6 " style="padding-top: 20px;">
              <img src="/img/favicon.png">
            </div>
          </div>
        </div>
      </div>
    </div>
    {{#if currentUser}}
    <div class="row col-lg-12 row-eq-height">
      <div class="col-lg-4">
        <a href='/refract'>
          <div class="panel panel-default">
            <div class= 'panel-body'>
              <h1>Take me to <span style='color: #7DC1BB;'>Refr</span><span style="color: #000000"><strong>act</strong></span></h1>
              <div>
                <img src="/img/sweet_sprites/icandy.png">
              </div>
            </div>
          </div>
        </a>
      </div>
      <div class="col-lg-4">
        <div class="panel panel-default" style="background-color: #eee;">
          <div class= 'panel-body'>
            <h1>Take me to <span style='color: #7DC1BB;'>Confr</span><span style="color: #000000"><strong>ont</strong></span></h1>
            <h2>Coming soon...</h2>
          </div>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="panel panel-default" style="background-color: #eee">
          <div class= 'panel-body'>
            <h1>Take me to <span style='color: #7DC1BB;'>Co</span><span style="color: #000000"><strong>ver</strong></span></h1>
            <h2>Coming soon...</h2>
          </div>
        </div>
      </div>
    </div>
    {{/if}}
</template>

<template name="main">

    {{>navigation}}
    <div id="wrapper">
      <div id='main'>
        {{#if isCurrentPage 'home'}}
          {{> home}}
        {{/if}}
        {{#if isCurrentPage 'about'}}
          {{> about}}
        {{/if}}
        {{#if isCurrentPage 'contact'}}
          {{> contact}}
        {{/if}}
        {{#if isCurrentPage 'rules'}}
          {{> rules}}
        {{/if}}
        {{#if isCurrentPage 'refract'}}
          {{> refract}}
        {{/if}}
        {{#if isCurrentPage 'leaderboard'}}
          {{> leaderboard}}
        {{/if}}
      </div>
    </div>
    <div class="push"></div>

  <div class="footer">
    <p>Copyright &copy; Refract, 2015. Inspired by Andrew Gridley. Developed by <a href='eatyourpeas.co.uk'>@eatyourpeas</a></p>
  </div>

  {{> loginModal}}
</template>

<template name="navigation">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        {{> navbrand}}
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
            {{> navbaritemsleft}}
        </ul>
        <ul class="nav navbar-nav navbar-right">
          {{> navbaritemsright}}
        </ul>
      </div> <!-- /.navbar-collapse -->
    </div> <!-- /.container-fluid -->
  </nav>
</template>

<template name = "navbrand">
  <img class = "navbar-brand" src="/img/favicon.png" height="50px">
  <a class="navbar-brand" href="{{ pathFor route='home' }}" data-route="home">Refr<strong>act</strong></a>
</template>

<template name = 'navbaritemsleft'>
  <li class="{{ activeIfTemplateIs 'home' }}"><a href="{{ pathFor route='home' }}" data-route="home">Home<span class="sr-only">(current)</span></a></li>
  <li class="{{ activeIfTemplateIs 'about' }}"><a href="{{ pathFor route='about' }}" data-route="about">About</a></li>
  {{#if currentUser}}
      {{> gamesdropdown}}
  {{/if}}
</template>

<template name = 'navbaritemsright'>
    <li>{{> loginButtons}}</li>
</template>

<template name = "gamesdropdown">
  <li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Games<span class="caret"></span></a>
      <ul class="dropdown-menu">
        <li class="{{ activeIfTemplateIs 'rules' }}"><a href="{{ pathFor route='rules' }}" data-route="rules">Rules of Refracting</a></li>
        <li class="{{ activeIfTemplateIs 'refract' }}"><a href="{{ pathFor route='refract' }}" data-route="refract">Play Refract</a></li>
        <li role="separator" class="divider"></li>
        <li class="{{ activeIfTemplateIs 'leaderboard' }}"><a href="{{ pathFor route='leaderboard' }}" data-route="leaderboard">Leaderboard</a></li>
        <li role="separator" class="divider"></li>
      </ul>
  </li>
</template>

<template name="about">
  <div class="row">
    <div class="col-md-6 text-center">
      <img class="img-circle" src="/img/andy.png" width="180px" height="180px">
      <h2>Andy Gridley</h2>
      <lead class='tagline'>The brains</lead>
      <p>Optometrist, teacher and academic.</p>
    </div>
    <div class="col-md-6 text-center">
      <img class="img-circle" src="/img/simon.png" width="180px" height="180px">
      <h2>Simon Chapman</h2>
      <lead class="tagline">The (coding) brawn</lead>
      <p>Geek, medic.</p>
    </div>
  </div>
</template>

<template name="rules">
  <div class="row">
    <div class="col-md-3"></div>
    <div class="col-md-6 text-left" id='rules'>
      <h2>The Rules</h2>
      <p> Lenses of different strengths (Ds) are laid out on tray before you. Use the trainer frame below to place them. The patient's refractive error will be shown on the Snellen chart - use this to work out what their prescription is. Remember, you are against the clock.</p>
      <p> Drag the lenses onto the frames one at a time: you can drop them when you see the frame dim - they will slide themselves into place. The clock will start as soon as you place your first lens.</p>
      <p> You have space for five lenses - if you need more, replace a weaker lens with a stronger one. To remove lenses from the frame, drag them off to the side, or click the one you want to remove once and it will return automatically to its pile. Good luck! </p>
    </div>
  </div>
</template>

<template name="refract">
  {{> refractGame}}
</template>

<template name="contact">
  <div class="container">
    <h1>Contact</h1>
    <p>Contact information will go here.</p>
  </div>
</template>

<template name="loginButtons">
  {{#if currentUser}}
    <div class="dropdown">
      <a href="#" class="dropdown-toggle btn btn-primary btn-sm" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        {{#if currentUser.profile.name}}{{currentUser.profile.name}}{{else}}{{currentUser.username}}{{/if}} <span class="caret"></span>
      </a>
      <ul class="dropdown-menu dropdown-menu-right">
        <li><a href="#" id="logout-link">Logout</a></li>
      </ul>
    </div>
  {{else}}
    <a href="#" class="btn btn-primary btn-sm" id="login-link">Login</a>
  {{/if}}
</template>

<template name="loginModal">
  <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title" id="loginModalLabel">{{#if isSignUp}}Sign Up{{else}}Login{{/if}}</h4>
        </div>
        <div class="modal-body">
          {{#if errorMessage}}
            <div class="alert alert-danger">{{errorMessage}}</div>
          {{/if}}
          
          <form id="auth-form">
            {{#if isSignUp}}
              <div class="form-group">
                <label for="signup-name">Name or Alias</label>
                <input type="text" class="form-control" id="signup-name" placeholder="Enter your name or alias" required>
              </div>
            {{/if}}
            
            <div class="form-group">
              <label for="auth-email">Email</label>
              <input type="email" class="form-control" id="auth-email" placeholder="Enter email" required>
            </div>
            
            <div class="form-group">
              <label for="auth-password">Password</label>
              <input type="password" class="form-control" id="auth-password" placeholder="Password" required>
            </div>
            
            {{#if isSignUp}}
              <div class="form-group">
                <label for="signup-password-confirm">Confirm Password</label>
                <input type="password" class="form-control" id="signup-password-confirm" placeholder="Confirm password" required>
              </div>
            {{/if}}
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary" id="auth-submit">
            {{#if isSignUp}}Sign Up{{else}}Login{{/if}}
          </button>
          <hr>
          <p class="text-center">
            {{#if isSignUp}}
              Already have an account? <a href="#" id="switch-to-login">Login here</a>
            {{else}}
              Need an account? <a href="#" id="switch-to-signup">Sign up here</a>
            {{/if}}
          </p>
        </div>
      </div>
    </div>
  </div>
</template>
